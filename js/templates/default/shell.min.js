function Template(){}Template.addMessage=function(b,a){if(a===undefined){a="alert-info"}if(b!==undefined){$("div#page-messages").append('<div class="alert '+a+' col-md-10 col-md-offset-1"><button type="button" class="close" data-dismiss="alert">&times;</button>'+b+"</div>")}};Template.addErrorMessage=function(a){Template.addMessage(a,"alert-danger")};function addMessage(b,a){Template.addMessage()}function addErrorMessage(a){Template.addErrorMessage(a)}Template.enableFormCandy=function(){$(".ctrl-enter-submit").keypress(function(a){var b=(a.which?a.which:a.keyCode);if((b==10||b==13)&&a.ctrlKey){$(this).closest("form").submit()}})};Template.enablePagination=function(){$(".pager-xhr a").click(function(j){j.preventDefault();var b=$(this).closest(".pager-xhr");var d=parseInt(b.attr("data-offset"));var c=parseInt(b.attr("data-limit"));var i=parseInt(b.attr("data-count"));var f=$("#"+b.attr("data-control-id"));var a=b.attr("data-source-url");var k=$(this).attr("rel");var h=$(this).closest(".pager-xhr").find("li.newer");var l=$(this).closest(".pager-xhr").find("li.older");a=a.split("?")[0];var g;if(k=="next"){g=d-c;if(g<0){g=0}}else{g=d+c;if(g>(i-1)){g=i-1}}a=a+"?offset="+g.toString()+"&limit="+c.toString();f.load(a,function(m,e,n){if(e!="error"){b.attr("data-offset",g.toString());h.removeClass("pagination-disabled");l.removeClass("pagination-disabled");if(g==0){h.addClass("pagination-disabled")}if(g>i-c){l.addClass("pagination-disabled")}f.scrollTop(0)}})})};Template.enableRichTextRequired=function(){$("textarea.validation-required").each(function(){var b=$(this).closest("form");var a=$(this);var c=$(this).closest("div.richtext-container").find("div.alert");b.submit(function(d){c.hide();if(a.val().length==0){d.preventDefault();console.error("Required richtext field "+a.attr("name")+" is blank, preventing form submission");c.show().focus()}})})};Template.enableImageFallback=function(){$("img").on("error",function(){console.error("Loading fallback image "+known.config.displayUrl+"gfx/users/default.png");$(this).attr("src",known.config.displayUrl+"gfx/users/default.png")})};function annotateContent(){$(".h-entry").fitVids();$("time.dt-published").timeago()}$(document).ready(function(){$.timeago.settings.cutoff=30*24*60*60*1000;annotateContent()});(function(a,c,d){if((d in c)&&c[d]){var f,b=a.location,e=/^(a|html)$/i;a.addEventListener("click",function(g){f=g.target;while(!(e).test(f.nodeName)){f=f.parentNode}if("href" in f&&(f.href.indexOf("http")||~f.href.indexOf(b.host))&&(!f.classList.contains("contentTypeButton"))){g.preventDefault();b.href=f.href}},false)}})(document,window.navigator,"standalone");$(document).ready(function(){$("body").on("click",function(c,b){var a=c.target;if(a.href&&a.href.indexOf(window.location.origin)===-1){a.target="_blank"}})});$(document).ready(function(){Template.enableFormCandy();Template.enablePagination();Template.enableRichTextRequired();Template.enableImageFallback()});